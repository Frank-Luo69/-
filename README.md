# 大衍筮法 · 准确实现（蓍草法）

> 目标：把“分二、挂一、揲四、归奇”的三变流程 **严谨复现**，以最准确的“计算与逻辑”为核心；提供可选种子（可复现）与安全随机两种模式；提供互/综/错等推导结果；附带概率模拟脚本验证 6/7/8/9 分布。

## 快速开始

```bash
pnpm install   # 或 npm/yarn
pnpm dev       # http://localhost:3000
```

- 页面留空起卦=安全随机；输入任意字符作为种子=可复现模式（Mulberry32 PRNG）。
- 结果页给出：本卦、之卦、互卦、综卦、错卦，以及每一爻“三变”的过程明细（教学/验算）。
- 八卦名称/符号已内置；六十四卦名/序可在后续加入 JSON 资源库。

## 验证概率分布（统计）

```bash
pnpm simulate
```

会输出 6/7/8/9 的频率与百分比，应接近期望：
- 6（老阴）≈ 1/16 = 6.25%
- 7（少阳）≈ 5/16 = 31.25%
- 8（少阴）≈ 7/16 = 43.75%
- 9（老阳）≈ 3/16 = 18.75%

## 关键实现说明

- **第1变**：49 根 → 随机分两堆 A/B（两边非空）；从 B 取出 1 根“挂一”；对 A 与 (B-1) 各做“按四数余（余0计4）”，移出，累计**取走 5 或 9**。  
- **第2/3变**：对剩余数重复“随机分两堆 + 两边按四数余”，每次**取走 4 或 8**。  
- 三变后剩余只可能在 {24,28,32,36}；除以 4 得爻值 {6,7,8,9}。  
- 之卦：仅在动位（6、9）处翻转阴阳（6→阳 9→阴）；互卦取二三四、三四五；综卦上下倒置；错卦全反。

## 目录
```
app/
  layout.tsx
  page.tsx
components/
  HexagramCard.tsx
lib/
  random.ts
  yarrow.ts
  types.ts
scripts/
  simulate.ts
tailwind.config.ts
postcss.config.js
next.config.mjs
tsconfig.json
package.json
README.md
```

## 许可
- 代码 MIT；本应用用于文化学习与研究，不构成任何决策建议。
